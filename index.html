<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>13.12</title>
<link href="https://fonts.googleapis.com/css2?family=Great+Vibes&display=swap" rel="stylesheet">
<style>
body{margin:0;overflow:hidden;background:black;font-family:'Great Vibes',cursive;}
canvas{position:fixed;top:0;left:0;}
#text{
position:absolute;
top:50%;
left:50%;
transform:translate(-50%,-50%);
font-size:3rem;
opacity:0;
color:white;
text-align:center;
text-shadow:0 0 25px pink;
transition:1s;
}
</style>
</head>
<body>

<canvas id="c"></canvas>
<div id="text"></div>

<script>
const canvas=document.getElementById("c");
const ctx=canvas.getContext("2d");
canvas.width=innerWidth;
canvas.height=innerHeight;

let state="warp";
let speed=3;
let stars=[];
let heartStars=[];
let textIndex=0;

const story=[
"Es begann mit einem Moment.",
"Ein Blick.",
"Ein Gef√ºhl.",
"Seit dem 13.12.",
"Fliege ich nicht mehr allein."
];

/* ================= GALAXY BACKGROUND ================= */

let galaxy=[];
for(let i=0;i<1200;i++){
let angle=Math.random()*Math.PI*4;
let radius=Math.random()*canvas.width/2;
galaxy.push({
angle:angle,
radius:radius,
size:Math.random()*1.5,
color:`hsla(${260+Math.random()*80},70%,70%,0.3)`
});
}

function drawGalaxy(){
ctx.save();
ctx.translate(canvas.width/2,canvas.height/2);
ctx.rotate(Date.now()*0.00005);

galaxy.forEach(g=>{
let x=Math.cos(g.angle)*g.radius;
let y=Math.sin(g.angle)*g.radius*0.6;
ctx.fillStyle=g.color;
ctx.beginPath();
ctx.arc(x,y,g.size,0,Math.PI*2);
ctx.fill();
});
ctx.restore();
}

/* ================= WARP STARS ================= */

for(let i=0;i<1000;i++){
stars.push({
x:(Math.random()-0.5)*canvas.width,
y:(Math.random()-0.5)*canvas.height,
z:Math.random()*canvas.width
});
}

function drawWarp(){
stars.forEach(s=>{
s.z-=speed;
if(s.z<=0) s.z=canvas.width;

let k=128/s.z;
let px=s.x*k+canvas.width/2;
let py=s.y*k+canvas.height/2;

ctx.fillStyle="white";
ctx.fillRect(px,py,2,2);
});
}

/* ================= MAIN LOOP ================= */

function animate(){
ctx.fillStyle="black";
ctx.fillRect(0,0,canvas.width,canvas.height);

drawGalaxy();

if(state==="warp") drawWarp();

if(state==="explode" || state==="heart"){
heartStars.forEach(s=>{
ctx.fillStyle=s.color;
ctx.globalAlpha=s.alpha;
ctx.beginPath();
ctx.arc(s.x,s.y,2,0,Math.PI*2);
ctx.fill();
});
ctx.globalAlpha=1;
}

requestAnimationFrame(animate);
}
animate();

/* ================= STORY ================= */

document.addEventListener("click",()=>{
if(textIndex<story.length){
speed+=1;
let t=document.getElementById("text");
t.innerHTML=story[textIndex];
t.style.opacity=1;
setTimeout(()=>t.style.opacity=0,2000);
textIndex++;
}else if(state==="warp"){
startExplosion();
}
});

/* ================= EXPLOSION ================= */

function startExplosion(){
state="explode";
heartStars=[];
for(let i=0;i<800;i++){
heartStars.push({
x:canvas.width/2,
y:canvas.height/2,
vx:(Math.random()-0.5)*14,
vy:(Math.random()-0.5)*14,
color:"white",
alpha:1
});
}
explode();
}

function explode(){
let finished=true;

heartStars.forEach(s=>{
s.x+=s.vx;
s.y+=s.vy;
s.vx*=0.95;
s.vy*=0.95;

let mag=Math.abs(s.vx)+Math.abs(s.vy);
if(mag>0.5) finished=false;

s.color=`hsl(${320+Math.random()*30},80%,70%)`;
});

if(!finished){
requestAnimationFrame(explode);
}else{
formHeart();
}
}

/* ================= HEART ================= */

function formHeart(){
state="heart";
let shape=[];

for(let t=0;t<Math.PI*2;t+=0.03){
let x=16*Math.pow(Math.sin(t),3);
let y=13*Math.cos(t)-5*Math.cos(2*t)-2*Math.cos(3*t)-Math.cos(4*t);
shape.push({
x:canvas.width/2+x*12,
y:canvas.height/2-y*12
});
}

heartStars.forEach((s,i)=>{
let p=shape[i%shape.length];
s.targetX=p.x;
s.targetY=p.y;
});

moveToHeart();
}

function moveToHeart(){
let done=true;

heartStars.forEach(s=>{
s.x+=(s.targetX-s.x)*0.06;
s.y+=(s.targetY-s.y)*0.06;

if(Math.abs(s.x-s.targetX)>0.5) done=false;
});

if(!done){
requestAnimationFrame(moveToHeart);
}else{
twinkle();
showFinal();
}
}

/* ================= TWINKLE EFFECT ================= */

function twinkle(){
setInterval(()=>{
heartStars.forEach(s=>{
s.alpha=0.6+Math.random()*0.4;
});
},300);
}

/* ================= FINAL TEXT ================= */

function showFinal(){
let t=document.getElementById("text");
t.innerHTML="Ich liebe dich.";
t.style.opacity=1;
}
</script>

</body>
</html>